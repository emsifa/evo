"use strict";(self.webpackChunkevo=self.webpackChunkevo||[]).push([[839],{3905:function(t,e,a){a.d(e,{Zo:function(){return m},kt:function(){return k}});var n=a(7294);function r(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function l(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function p(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?l(Object(a),!0).forEach((function(e){r(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function o(t,e){if(null==t)return{};var a,n,r=function(t,e){if(null==t)return{};var a,n,r={},l=Object.keys(t);for(n=0;n<l.length;n++)a=l[n],e.indexOf(a)>=0||(r[a]=t[a]);return r}(t,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(n=0;n<l.length;n++)a=l[n],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(r[a]=t[a])}return r}var i=n.createContext({}),s=function(t){var e=n.useContext(i),a=e;return t&&(a="function"==typeof t?t(e):p(p({},e),t)),a},m=function(t){var e=s(t.components);return n.createElement(i.Provider,{value:e},t.children)},u={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},d=n.forwardRef((function(t,e){var a=t.components,r=t.mdxType,l=t.originalType,i=t.parentName,m=o(t,["components","mdxType","originalType","parentName"]),d=s(a),k=r,c=d["".concat(i,".").concat(k)]||d[k]||u[k]||l;return a?n.createElement(c,p(p({ref:e},m),{},{components:a})):n.createElement(c,p({ref:e},m))}));function k(t,e){var a=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var l=a.length,p=new Array(l);p[0]=d;var o={};for(var i in e)hasOwnProperty.call(e,i)&&(o[i]=e[i]);o.originalType=t,o.mdxType="string"==typeof t?t:r,p[1]=o;for(var s=2;s<l;s++)p[s]=a[s];return n.createElement.apply(null,p)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},5603:function(t,e,a){a.r(e),a.d(e,{frontMatter:function(){return o},contentTitle:function(){return i},metadata:function(){return s},toc:function(){return m},default:function(){return d}});var n=a(7462),r=a(3366),l=(a(7294),a(3905)),p=["components"],o={sidebar_position:4},i="DTO",s={unversionedId:"dto",id:"dto",isDocsHomePage:!1,title:"DTO",description:"DTO (Data Transfer Object) is basically an object that contains some declared properties in it. DTO used to carry data between processes. In typical PHP application, we often store data as associative array or as stdClass. The downside of storing data as associative array or stdClass is we don't really know what is inside and what type it is. If we are not carefully to check it, it could cause some security problem to our application.",source:"@site/docs/dto.md",sourceDirName:".",slug:"/dto",permalink:"/evo/docs/dto",editUrl:"https://github.com/emsifa/evo/edit/main/website/docs/dto.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Request",permalink:"/evo/docs/request"},next:{title:"Validation",permalink:"/evo/docs/validation"}},m=[{value:"Generating DTO File",id:"generating-dto-file",children:[]},{value:"Default Casters",id:"default-casters",children:[{value:"<code>BoolCaster</code>",id:"boolcaster",children:[]},{value:"<code>IntCaster</code>",id:"intcaster",children:[]},{value:"<code>FloatCaster</code>",id:"floatcaster",children:[]},{value:"<code>FloatCaster</code>",id:"floatcaster-1",children:[]},{value:"<code>StringCaster</code>",id:"stringcaster",children:[]},{value:"<code>ArrayCaster</code>",id:"arraycaster",children:[]},{value:"<code>CollectionCaster</code>",id:"collectioncaster",children:[]},{value:"<code>DateTimeCaster</code>",id:"datetimecaster",children:[]}]},{value:"Creating Custom Type Caster",id:"creating-custom-type-caster",children:[]}],u={toc:m};function d(t){var e=t.components,a=(0,r.Z)(t,p);return(0,l.kt)("wrapper",(0,n.Z)({},u,a,{components:e,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"dto"},"DTO"),(0,l.kt)("p",null,"DTO (Data Transfer Object) is basically an object that contains some declared properties in it. DTO used to carry data between processes. In typical PHP application, we often store data as associative array or as ",(0,l.kt)("inlineCode",{parentName:"p"},"stdClass"),". The downside of storing data as associative array or ",(0,l.kt)("inlineCode",{parentName:"p"},"stdClass")," is we don't really know what is inside and what type it is. If we are not carefully to check it, it could cause some security problem to our application."),(0,l.kt)("p",null,"By replacing them with DTO, we, Text Editor, and IDE know exactly what it is, what properties in it, the type of each properties, etc."),(0,l.kt)("p",null,"But creating DTO instance with PHP native way sometimes can be quite annoying. You have to create an instance, set the value for each properties one by one, also you have to cast its type properly."),(0,l.kt)("p",null,"That is why Evo provide ",(0,l.kt)("inlineCode",{parentName:"p"},"Emsifa\\Evo\\Dto")," class that comes with some useful utilities."),(0,l.kt)("p",null,"In the ",(0,l.kt)("a",{parentName:"p",href:"#body-attribute"},(0,l.kt)("inlineCode",{parentName:"a"},"Body")," Attribute")," section, we are creating ",(0,l.kt)("inlineCode",{parentName:"p"},"RegisterDto")," class that will be injected using ",(0,l.kt)("inlineCode",{parentName:"p"},"Body")," attribute. Yes, the validation process does comes from ",(0,l.kt)("inlineCode",{parentName:"p"},"Body")," attribute, but the ability to create ",(0,l.kt)("inlineCode",{parentName:"p"},"RegisterDto")," instance with the correct types for its properties is comes from its parent class: ",(0,l.kt)("inlineCode",{parentName:"p"},"Emsifa\\Evo\\Dto"),"."),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"Emsifa\\Evo\\Dto")," doing type casting by looking for type casters attached to it. If you look at the source of ",(0,l.kt)("inlineCode",{parentName:"p"},"Emsifa\\Evo\\Dto"),", you will see something like this:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-php"},"#[UseCaster('int', IntCaster::class)]\n#[UseCaster('float', FloatCaster::class)]\n#[UseCaster('string', StringCaster::class)]\n#[UseCaster('bool', BoolCaster::class)]\n#[UseCaster('array', ArrayCaster::class)]\n#[UseCaster(DateTime::class, DateTimeCaster::class)]\n#[UseCaster(Collection::class, CollectionCaster::class)]\nabstract class Dto implements Arrayable\n{\n    ...\n}\n")),(0,l.kt)("p",null,"In code above, ",(0,l.kt)("inlineCode",{parentName:"p"},"UseCaster")," is used to tell the DTO what caster class to be used to cast a type."),(0,l.kt)("p",null,"In this section we will explore how to generate DTO file, how default casters behave, and how to create and override default caster."),(0,l.kt)("h2",{id:"generating-dto-file"},"Generating DTO File"),(0,l.kt)("p",null,"We can generate DTO file using ",(0,l.kt)("inlineCode",{parentName:"p"},"evo:make-dto")," command. Below is the signature of the command:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"php artisan evo:make-dto {classname} {...properties}\n")),(0,l.kt)("p",null,"Argument ",(0,l.kt)("inlineCode",{parentName:"p"},"classname")," is required and ",(0,l.kt)("inlineCode",{parentName:"p"},"properties")," are optional."),(0,l.kt)("p",null,"For example, to create ",(0,l.kt)("inlineCode",{parentName:"p"},"LoginDto")," that have ",(0,l.kt)("inlineCode",{parentName:"p"},"string $email")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"string $password")," properties. We should run:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"php artisan evo:make-dto LoginDto email:string password:string\n")),(0,l.kt)("p",null,"It will generate ",(0,l.kt)("inlineCode",{parentName:"p"},"app/Dtos/LoginDto.php")," with code:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-php"},"<?php\n\nnamespace App\\Dto;\n\nuse Emsifa\\Evo\\Dto;\n\nclass LoginDto extends Dto\n{\n    public string $email;\n    public string $password;\n}\n\n")),(0,l.kt)("p",null,"You can also generate nested object by giving the name of the object for the type. For example:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"php artisan evo:make-dto SaveProfileDto name:string contact:ContactDto address:AddressDto\n")),(0,l.kt)("p",null,"It will generate 3 files below: "),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"app/Dtos/SaveProfileDto.php"),":"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-php"},"<?php\n\nnamespace App\\Dto;\n\nuse Emsifa\\Evo\\Dto;\n\nclass SaveProfileDto extends Dto\n{\n    public string $name;\n    public ContactDto $contact;\n    public AddressDto $contact;\n}\n"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"app/Dtos/ContactDto.php")," (if not exists):"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-php"},"<?php\n\nnamespace App\\Dto;\n\nuse Emsifa\\Evo\\Dto;\n\nclass ContactDto extends Dto\n{\n}\n"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"app/Dtos/AddressDto.php")," (if not exists):"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-php"},"<?php\n\nnamespace App\\Dto;\n\nuse Emsifa\\Evo\\Dto;\n\nclass AddressDto extends Dto\n{\n}\n")))),(0,l.kt)("p",null,"You can also generate typed array by adding ",(0,l.kt)("inlineCode",{parentName:"p"},"[]")," sign after type name. For example:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"php artisan evo:make-dto CheckoutOrderDto items:CheckoutItemDto[]\n")),(0,l.kt)("p",null,"It will generate:"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"app/Dtos/CheckoutOrderDto.php"),":"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-php"},"<?php\n\nnamespace App\\Dto;\n\nuse Emsifa\\Evo\\Dto;\nuse Emsifa\\Evo\\Types\\ArrayOf;\n\nclass CheckoutOrderDto extends Dto\n{\n    #[ArrayOf(CheckoutItemDto::class)]\n    public array $items;\n}\n"))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("inlineCode",{parentName:"p"},"app/Dtos/CheckoutItemDto.php")," (if not exists):"),(0,l.kt)("pre",{parentName:"li"},(0,l.kt)("code",{parentName:"pre",className:"language-php"},"<?php\n\nnamespace App\\Dto;\n\nuse Emsifa\\Evo\\Dto;\n\nclass CheckoutItemDto extends Dto\n{\n}\n")))),(0,l.kt)("h2",{id:"default-casters"},"Default Casters"),(0,l.kt)("p",null,"Here are some examples of Evo's default casters behave:"),(0,l.kt)("h3",{id:"boolcaster"},(0,l.kt)("inlineCode",{parentName:"h3"},"BoolCaster")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Property"),(0,l.kt)("th",{parentName:"tr",align:null},"Original Value"),(0,l.kt)("th",{parentName:"tr",align:null},"Casted Value"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"bool $property"),(0,l.kt)("td",{parentName:"tr",align:null},"null"),(0,l.kt)("td",{parentName:"tr",align:null},"false")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"?bool $property"),(0,l.kt)("td",{parentName:"tr",align:null},"null"),(0,l.kt)("td",{parentName:"tr",align:null},"null")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"bool $property"),(0,l.kt)("td",{parentName:"tr",align:null},"true"),(0,l.kt)("td",{parentName:"tr",align:null},"true")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"bool $property"),(0,l.kt)("td",{parentName:"tr",align:null},"false"),(0,l.kt)("td",{parentName:"tr",align:null},"false")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"bool $property"),(0,l.kt)("td",{parentName:"tr",align:null},'"true"'),(0,l.kt)("td",{parentName:"tr",align:null},"true")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"bool $property"),(0,l.kt)("td",{parentName:"tr",align:null},'"false"'),(0,l.kt)("td",{parentName:"tr",align:null},"false")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"bool $property"),(0,l.kt)("td",{parentName:"tr",align:null},"1"),(0,l.kt)("td",{parentName:"tr",align:null},"true")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"bool $property"),(0,l.kt)("td",{parentName:"tr",align:null},"0"),(0,l.kt)("td",{parentName:"tr",align:null},"false")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"bool $property"),(0,l.kt)("td",{parentName:"tr",align:null},'"1"'),(0,l.kt)("td",{parentName:"tr",align:null},"true")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"bool $property"),(0,l.kt)("td",{parentName:"tr",align:null},'"0"'),(0,l.kt)("td",{parentName:"tr",align:null},"false")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"bool $property"),(0,l.kt)("td",{parentName:"tr",align:null},"123"),(0,l.kt)("td",{parentName:"tr",align:null},"CastErrorException")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"bool $property"),(0,l.kt)("td",{parentName:"tr",align:null},"123.45"),(0,l.kt)("td",{parentName:"tr",align:null},"CastErrorException")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"bool $property"),(0,l.kt)("td",{parentName:"tr",align:null},'"123"'),(0,l.kt)("td",{parentName:"tr",align:null},"CastErrorException")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"bool $property"),(0,l.kt)("td",{parentName:"tr",align:null},'"123.45"'),(0,l.kt)("td",{parentName:"tr",align:null},"CastErrorException")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"bool $property"),(0,l.kt)("td",{parentName:"tr",align:null},'"lorem ipsum"'),(0,l.kt)("td",{parentName:"tr",align:null},"CastErrorException")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"bool $property"),(0,l.kt)("td",{parentName:"tr",align:null},"[]"),(0,l.kt)("td",{parentName:"tr",align:null},"CastErrorException")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"bool $property"),(0,l.kt)("td",{parentName:"tr",align:null},"[1,2,3]"),(0,l.kt)("td",{parentName:"tr",align:null},"CastErrorException")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"bool $property"),(0,l.kt)("td",{parentName:"tr",align:null},"stdClass"),(0,l.kt)("td",{parentName:"tr",align:null},"CastErrorException")))),(0,l.kt)("h3",{id:"intcaster"},(0,l.kt)("inlineCode",{parentName:"h3"},"IntCaster")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Property"),(0,l.kt)("th",{parentName:"tr",align:null},"Original Value"),(0,l.kt)("th",{parentName:"tr",align:null},"Casted Value"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"int $number"),(0,l.kt)("td",{parentName:"tr",align:null},"null"),(0,l.kt)("td",{parentName:"tr",align:null},"0")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"?int $number"),(0,l.kt)("td",{parentName:"tr",align:null},"null"),(0,l.kt)("td",{parentName:"tr",align:null},"null")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"int $number"),(0,l.kt)("td",{parentName:"tr",align:null},"123"),(0,l.kt)("td",{parentName:"tr",align:null},"123")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"int $number"),(0,l.kt)("td",{parentName:"tr",align:null},'"123"'),(0,l.kt)("td",{parentName:"tr",align:null},"123")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"int $number"),(0,l.kt)("td",{parentName:"tr",align:null},"123.45"),(0,l.kt)("td",{parentName:"tr",align:null},"123")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"int $number"),(0,l.kt)("td",{parentName:"tr",align:null},'"123.45"'),(0,l.kt)("td",{parentName:"tr",align:null},"123")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"int $number"),(0,l.kt)("td",{parentName:"tr",align:null},'"123.99"'),(0,l.kt)("td",{parentName:"tr",align:null},"123")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"int $number"),(0,l.kt)("td",{parentName:"tr",align:null},"true"),(0,l.kt)("td",{parentName:"tr",align:null},"CastErrorException")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"int $number"),(0,l.kt)("td",{parentName:"tr",align:null},"false"),(0,l.kt)("td",{parentName:"tr",align:null},"CastErrorException")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"int $number"),(0,l.kt)("td",{parentName:"tr",align:null},'"123-ipsum"'),(0,l.kt)("td",{parentName:"tr",align:null},"CastErrorException")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"int $number"),(0,l.kt)("td",{parentName:"tr",align:null},'"123-ipsum"'),(0,l.kt)("td",{parentName:"tr",align:null},"CastErrorException")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"int $number"),(0,l.kt)("td",{parentName:"tr",align:null},"[]"),(0,l.kt)("td",{parentName:"tr",align:null},"CastErrorException")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"int $number"),(0,l.kt)("td",{parentName:"tr",align:null},"stdClass"),(0,l.kt)("td",{parentName:"tr",align:null},"CastErrorException")))),(0,l.kt)("h3",{id:"floatcaster"},(0,l.kt)("inlineCode",{parentName:"h3"},"FloatCaster")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Property"),(0,l.kt)("th",{parentName:"tr",align:null},"Original Value"),(0,l.kt)("th",{parentName:"tr",align:null},"Casted Value"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"float $number"),(0,l.kt)("td",{parentName:"tr",align:null},"null"),(0,l.kt)("td",{parentName:"tr",align:null},"0")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"?float $number"),(0,l.kt)("td",{parentName:"tr",align:null},"null"),(0,l.kt)("td",{parentName:"tr",align:null},"null")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"float $number"),(0,l.kt)("td",{parentName:"tr",align:null},"123"),(0,l.kt)("td",{parentName:"tr",align:null},"123.0")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"float $number"),(0,l.kt)("td",{parentName:"tr",align:null},'"123"'),(0,l.kt)("td",{parentName:"tr",align:null},"123.0")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"float $number"),(0,l.kt)("td",{parentName:"tr",align:null},"123.45"),(0,l.kt)("td",{parentName:"tr",align:null},"123.45")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"float $number"),(0,l.kt)("td",{parentName:"tr",align:null},'"123.45"'),(0,l.kt)("td",{parentName:"tr",align:null},"123.45")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"float $number"),(0,l.kt)("td",{parentName:"tr",align:null},'"123.99"'),(0,l.kt)("td",{parentName:"tr",align:null},"123.99")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"float $number"),(0,l.kt)("td",{parentName:"tr",align:null},"true"),(0,l.kt)("td",{parentName:"tr",align:null},"CastErrorException")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"float $number"),(0,l.kt)("td",{parentName:"tr",align:null},"false"),(0,l.kt)("td",{parentName:"tr",align:null},"CastErrorException")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"float $number"),(0,l.kt)("td",{parentName:"tr",align:null},'"123-ipsum"'),(0,l.kt)("td",{parentName:"tr",align:null},"CastErrorException")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"float $number"),(0,l.kt)("td",{parentName:"tr",align:null},'"123-ipsum"'),(0,l.kt)("td",{parentName:"tr",align:null},"CastErrorException")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"float $number"),(0,l.kt)("td",{parentName:"tr",align:null},"[]"),(0,l.kt)("td",{parentName:"tr",align:null},"CastErrorException")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"float $number"),(0,l.kt)("td",{parentName:"tr",align:null},"stdClass"),(0,l.kt)("td",{parentName:"tr",align:null},"CastErrorException")))),(0,l.kt)("h3",{id:"floatcaster-1"},(0,l.kt)("inlineCode",{parentName:"h3"},"FloatCaster")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Property"),(0,l.kt)("th",{parentName:"tr",align:null},"Original Value"),(0,l.kt)("th",{parentName:"tr",align:null},"Casted Value"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"float $number"),(0,l.kt)("td",{parentName:"tr",align:null},"null"),(0,l.kt)("td",{parentName:"tr",align:null},"0")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"?float $number"),(0,l.kt)("td",{parentName:"tr",align:null},"null"),(0,l.kt)("td",{parentName:"tr",align:null},"null")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"float $number"),(0,l.kt)("td",{parentName:"tr",align:null},"123"),(0,l.kt)("td",{parentName:"tr",align:null},"123.0")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"float $number"),(0,l.kt)("td",{parentName:"tr",align:null},'"123"'),(0,l.kt)("td",{parentName:"tr",align:null},"123.0")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"float $number"),(0,l.kt)("td",{parentName:"tr",align:null},"123.45"),(0,l.kt)("td",{parentName:"tr",align:null},"123.45")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"float $number"),(0,l.kt)("td",{parentName:"tr",align:null},'"123.45"'),(0,l.kt)("td",{parentName:"tr",align:null},"123.45")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"float $number"),(0,l.kt)("td",{parentName:"tr",align:null},'"123.99"'),(0,l.kt)("td",{parentName:"tr",align:null},"123.99")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"float $number"),(0,l.kt)("td",{parentName:"tr",align:null},"true"),(0,l.kt)("td",{parentName:"tr",align:null},"CastErrorException")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"float $number"),(0,l.kt)("td",{parentName:"tr",align:null},"false"),(0,l.kt)("td",{parentName:"tr",align:null},"CastErrorException")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"float $number"),(0,l.kt)("td",{parentName:"tr",align:null},'"123-ipsum"'),(0,l.kt)("td",{parentName:"tr",align:null},"CastErrorException")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"float $number"),(0,l.kt)("td",{parentName:"tr",align:null},'"123-ipsum"'),(0,l.kt)("td",{parentName:"tr",align:null},"CastErrorException")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"float $number"),(0,l.kt)("td",{parentName:"tr",align:null},"[]"),(0,l.kt)("td",{parentName:"tr",align:null},"CastErrorException")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"float $number"),(0,l.kt)("td",{parentName:"tr",align:null},"stdClass"),(0,l.kt)("td",{parentName:"tr",align:null},"CastErrorException")))),(0,l.kt)("h3",{id:"stringcaster"},(0,l.kt)("inlineCode",{parentName:"h3"},"StringCaster")),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Property"),(0,l.kt)("th",{parentName:"tr",align:null},"Original Value"),(0,l.kt)("th",{parentName:"tr",align:null},"Casted Value"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"string $str"),(0,l.kt)("td",{parentName:"tr",align:null},"null"),(0,l.kt)("td",{parentName:"tr",align:null},'""')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"?string $str"),(0,l.kt)("td",{parentName:"tr",align:null},"null"),(0,l.kt)("td",{parentName:"tr",align:null},"null")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"string $str"),(0,l.kt)("td",{parentName:"tr",align:null},"true"),(0,l.kt)("td",{parentName:"tr",align:null},'"true"')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"string $str"),(0,l.kt)("td",{parentName:"tr",align:null},"false"),(0,l.kt)("td",{parentName:"tr",align:null},'"false"')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"string $str"),(0,l.kt)("td",{parentName:"tr",align:null},'"123"'),(0,l.kt)("td",{parentName:"tr",align:null},'"123"')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"string $str"),(0,l.kt)("td",{parentName:"tr",align:null},"123"),(0,l.kt)("td",{parentName:"tr",align:null},'"123"')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"string $str"),(0,l.kt)("td",{parentName:"tr",align:null},"123.45"),(0,l.kt)("td",{parentName:"tr",align:null},'"123.45"')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"string $str"),(0,l.kt)("td",{parentName:"tr",align:null},"123.0"),(0,l.kt)("td",{parentName:"tr",align:null},'"123"')),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"string $str"),(0,l.kt)("td",{parentName:"tr",align:null},"Stringable"),(0,l.kt)("td",{parentName:"tr",align:null},"__toString()")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"string $str"),(0,l.kt)("td",{parentName:"tr",align:null},"[]"),(0,l.kt)("td",{parentName:"tr",align:null},"CastErrorException")))),(0,l.kt)("h3",{id:"arraycaster"},(0,l.kt)("inlineCode",{parentName:"h3"},"ArrayCaster")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"ArrayCaster")," basically only accept array and ",(0,l.kt)("inlineCode",{parentName:"p"},"Illuminate\\Contracts\\Support\\Arrayable")," value, other than that it throws ",(0,l.kt)("inlineCode",{parentName:"p"},"Emsifa\\Evo\\Exceptions\\CastErrorException"),"."),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"ArrayCaster")," will check ",(0,l.kt)("inlineCode",{parentName:"p"},"Emsifa\\Evo\\Types\\ArrayOf")," attribute to cast its items."),(0,l.kt)("p",null,"For example if you have property like this:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-php"},"#[ArrayOf('int')]\npublic array $numbers;\n")),(0,l.kt)("p",null,"And inject it with value: "),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-php"},'[1, "2", "3.0", null]\n')),(0,l.kt)("p",null,"Evo will apply ",(0,l.kt)("inlineCode",{parentName:"p"},"int")," caster to each items, so the result would be: "),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-php"},"[1, 2, 3, 0]\n")),(0,l.kt)("p",null,"In example above, if you inject it with value:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-php"},'[1, "2", "lorem-ipsum", null]\n')),(0,l.kt)("p",null,"It will throw ",(0,l.kt)("inlineCode",{parentName:"p"},"Emsifa\\Evo\\Exceptions\\CastErrorException"),"."),(0,l.kt)("p",null,"But sometimes you may want to treat it differently. Instead of thrown an error, you may want to skip the item, make it null, or just keep as is. That is why the second parameter of ",(0,l.kt)("inlineCode",{parentName:"p"},"ArrayOf")," comes in handy."),(0,l.kt)("p",null,"You can use ",(0,l.kt)("inlineCode",{parentName:"p"},"ArrayOf::SKIP_ITEM"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"ArrayOf::NULL_ITEM"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"ArrayOf::KEEP_AS_IS")," as second parameter of ",(0,l.kt)("inlineCode",{parentName:"p"},"ArrayOf")," attribute."),(0,l.kt)("p",null,"For example, if you change the property in example above like this:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-php"},"#[ArrayOf('int', ArrayOf::SKIP_ITEM)]\npublic array $numbers;\n")),(0,l.kt)("p",null,"And if you inject it with value:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-php"},'[1, "2", "lorem-ipsum", "4.2", "5"]\n')),(0,l.kt)("p",null,"It will give you this result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-php"},"[1, 2, 4, 5]\n")),(0,l.kt)("p",null,"If you change second parameter to ",(0,l.kt)("inlineCode",{parentName:"p"},"ArrayOf::NULL_ITEM"),", it would give you the result below:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-php"},"[1, 2, null, 4, 5]\n")),(0,l.kt)("p",null,"Lastly if you change second parameter to ",(0,l.kt)("inlineCode",{parentName:"p"},"ArrayOf::KEEP_AS_IS"),", it would give you this result:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-php"},'[1, 2, "lorem-ipsum", 4, 5]\n')),(0,l.kt)("h3",{id:"collectioncaster"},(0,l.kt)("inlineCode",{parentName:"h3"},"CollectionCaster")),(0,l.kt)("p",null,"Same like ",(0,l.kt)("inlineCode",{parentName:"p"},"ArrayCaster"),", but it will apply ",(0,l.kt)("inlineCode",{parentName:"p"},"collect($result)")," to transform the result into ",(0,l.kt)("inlineCode",{parentName:"p"},"Illuminate\\Support\\Collection")," instance."),(0,l.kt)("h3",{id:"datetimecaster"},(0,l.kt)("inlineCode",{parentName:"h3"},"DateTimeCaster")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"DateTimeCaster")," will transform any string that is accepted by ",(0,l.kt)("inlineCode",{parentName:"p"},"date_create()")," function to ",(0,l.kt)("inlineCode",{parentName:"p"},"DateTime")," object."),(0,l.kt)("p",null,"For example:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-php"},"public DateTime $date;\n")),(0,l.kt)("p",null,"It would transform string ",(0,l.kt)("inlineCode",{parentName:"p"},'"2010-01-02"'),", ",(0,l.kt)("inlineCode",{parentName:"p"},'"2010-01-02 12:34:56"'),", etc into ",(0,l.kt)("inlineCode",{parentName:"p"},"DateTime")," instance."),(0,l.kt)("p",null,"If ",(0,l.kt)("inlineCode",{parentName:"p"},"date_create()")," returns ",(0,l.kt)("inlineCode",{parentName:"p"},"null"),", it would throws ",(0,l.kt)("inlineCode",{parentName:"p"},"Emsifa\\Evo\\Exceptions\\CastErrorException"),"."),(0,l.kt)("h2",{id:"creating-custom-type-caster"},"Creating Custom Type Caster"),(0,l.kt)("p",null,"To create your own type caster, you have to create a class implementing ",(0,l.kt)("inlineCode",{parentName:"p"},"Emsifa\\Evo\\Contracts\\Caster")," interface."),(0,l.kt)("p",null,"In this example we will create a boolean caster. Also we will override Evo's default boolean caster with our custom caster."),(0,l.kt)("p",null,"First, let's create file ",(0,l.kt)("inlineCode",{parentName:"p"},"BoolCaster.php")," in ",(0,l.kt)("inlineCode",{parentName:"p"},"app/Casters")," directory. If you don't have ",(0,l.kt)("inlineCode",{parentName:"p"},"Casters")," directory yet, just create it."),(0,l.kt)("p",null,"Then let's write this blank caster code:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-php"},"<?php\n\nnamespace App\\Casters;\n\nuse Emsifa\\Evo\\Contracts\\Caster;\nuse Emsifa\\Evo\\Exceptions\\CastErrorException;\nuse ReflectionParameter;\nuse ReflectionProperty;\n\nclass BoolCaster implements Caster\n{\n    public function cast($value, ReflectionProperty | ReflectionParameter $prop): mixed\n    {\n        // ...\n    }\n}\n")),(0,l.kt)("p",null,"Now we will put some logic to our ",(0,l.kt)("inlineCode",{parentName:"p"},"cast")," method. For example in this custom ",(0,l.kt)("inlineCode",{parentName:"p"},"BoolCaster")," we want to convert string ",(0,l.kt)("inlineCode",{parentName:"p"},'"1"'),", ",(0,l.kt)("inlineCode",{parentName:"p"},'"true"'),", ",(0,l.kt)("inlineCode",{parentName:"p"},'"on"'),", ",(0,l.kt)("inlineCode",{parentName:"p"},'"yes"')," to ",(0,l.kt)("inlineCode",{parentName:"p"},"true")," and ",(0,l.kt)("inlineCode",{parentName:"p"},'"0"'),", ",(0,l.kt)("inlineCode",{parentName:"p"},'"false"'),", ",(0,l.kt)("inlineCode",{parentName:"p"},'"no"'),", ",(0,l.kt)("inlineCode",{parentName:"p"},'"off"')," to ",(0,l.kt)("inlineCode",{parentName:"p"},"false"),". Also, we want to make sure if our property is nullable, and the value is ",(0,l.kt)("inlineCode",{parentName:"p"},"null"),", we should returns ",(0,l.kt)("inlineCode",{parentName:"p"},"null"),". Else we will throw ",(0,l.kt)("inlineCode",{parentName:"p"},"Emsifa\\Evo\\Exceptions\\CastErrorException"),"."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-php"},'class BoolCaster implements Caster\n{\n    public function cast($value, ReflectionProperty | ReflectionParameter $prop): mixed\n    {\n        $nullable = optional($prop->getType())->allowsNull();\n        $truthy = [true, "true", 1, "1", "yes", "on"];\n        $falsy = [false, "false", 0, "0", "no", "off"];\n\n        return match (true) {\n            $nullable && is_null($value) => null,\n            in_array($value, $truthy, true) => true,\n            in_array($value, $falsy, true) => false,\n            default => throw new CastErrorException("Cannot cast boolean from type: " . gettype($value)),\n        };\n    }\n}\n')),(0,l.kt)("p",null,"Now our ",(0,l.kt)("inlineCode",{parentName:"p"},"BoolCaster")," is done. To use our ",(0,l.kt)("inlineCode",{parentName:"p"},"BoolCaster"),", we can attach ",(0,l.kt)("inlineCode",{parentName:"p"},"Emsifa\\Evo\\Dtos\\UseCaster")," attribute to our DTO class."),(0,l.kt)("p",null,"In this example we will attach it to ",(0,l.kt)("inlineCode",{parentName:"p"},"LoginDto")," class."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-php"},"<?php\n\nnamespace App\\Dto;\n\nuse Emsifa\\Evo\\Dto;\nuse Emsifa\\Evo\\Dtos\\UseCaster;\nuse App\\Casters\\BoolCaster;\n\n#[UseCaster('bool', BoolCaster::class)]\nclass LoginDto extends Dto\n{\n    public string $email;\n    public string $password;\n    public bool $remember;\n}\n")),(0,l.kt)("p",null,"Now, our ",(0,l.kt)("inlineCode",{parentName:"p"},"BoolCaster")," will be applied to cast ",(0,l.kt)("inlineCode",{parentName:"p"},"bool $remember")," property."),(0,l.kt)("p",null,"If you want to apply it to all of your DTO classes, you can create your own abstract DTO class to be used as a parent to all of your DTO classes."),(0,l.kt)("p",null,"For example, create your own ",(0,l.kt)("inlineCode",{parentName:"p"},"app/Dtos/Dto.php")," file with code below:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-php"},"<?php\n\nnamespace App\\Dto;\n\nuse Emsifa\\Evo\\Dto as EvoBaseDto;\nuse Emsifa\\Evo\\Dtos\\UseCaster;\nuse App\\Casters\\BoolCaster;\n\n#[UseCaster('bool', BoolCaster::class)]\nabstract class Dto extends EvoBaseDto\n{\n}\n")),(0,l.kt)("p",null,"Then in your DTO classes you just have to extends ",(0,l.kt)("inlineCode",{parentName:"p"},"App\\Dtos\\Dto")," class instead of ",(0,l.kt)("inlineCode",{parentName:"p"},"Emsifa\\Evo\\Dto"),"."))}d.isMDXComponent=!0}}]);