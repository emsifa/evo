"use strict";(self.webpackChunkevo=self.webpackChunkevo||[]).push([[911],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return k}});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var p=r.createContext({}),l=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=l(e.components);return r.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,p=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),m=l(n),k=o,d=m["".concat(p,".").concat(k)]||m[k]||u[k]||a;return n?r.createElement(d,i(i({ref:t},c),{},{components:n})):r.createElement(d,i({ref:t},c))}));function k(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=m;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var l=2;l<a;l++)i[l]=n[l];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},2101:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return p},metadata:function(){return l},toc:function(){return c},default:function(){return m}});var r=n(7462),o=n(3366),a=(n(7294),n(3905)),i=["components"],s={sidebar_position:8},p="Mocking API",l={unversionedId:"mocking-api",id:"mocking-api",isDocsHomePage:!1,title:"Mocking API",description:"Mocking API is a feature that allows your controller to send response with fake data.",source:"@site/docs/mocking-api.md",sourceDirName:".",slug:"/mocking-api",permalink:"/evo/docs/mocking-api",editUrl:"https://github.com/emsifa/evo/edit/main/website/docs/mocking-api.md",tags:[],version:"current",sidebarPosition:8,frontMatter:{sidebar_position:8},sidebar:"tutorialSidebar",previous:{title:"Swagger UI",permalink:"/evo/docs/swagger-ui"}},c=[{value:"Using <code>Mock</code> Attribute",id:"using-mock-attribute",children:[]},{value:"Using Specific Faker",id:"using-specific-faker",children:[]},{value:"Create Custom Faker",id:"create-custom-faker",children:[]}],u={toc:c};function m(e){var t=e.components,n=(0,o.Z)(e,i);return(0,a.kt)("wrapper",(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"mocking-api"},"Mocking API"),(0,a.kt)("p",null,"Mocking API is a feature that allows your controller to send response with fake data."),(0,a.kt)("p",null,"When developing REST API with a team consisting of Back-end and Front-end Developers. Creating an API implementation could takes time. Sometimes it makes Front-end developer have to wait Back-end Developer to finish the implementation. This will make development time less efficient."),(0,a.kt)("p",null,"To make development time more efficient. We can use Mocking API so Front-end Developer can consume our API without waiting for real implementation to be done."),(0,a.kt)("p",null,"To do that, in Evo you can simply attach ",(0,a.kt)("inlineCode",{parentName:"p"},"Emsifa\\Evo\\Http\\Response\\Mock")," attribute to your controller method. So when user call that endpoint, Evo will prevent its controller to be executed, instead Evo will read its return type, create return type instance and fill its properties with fake data, finally Evo will respond that fake instance."),(0,a.kt)("h2",{id:"using-mock-attribute"},"Using ",(0,a.kt)("inlineCode",{parentName:"h2"},"Mock")," Attribute"),(0,a.kt)("p",null,"For example, we will use ",(0,a.kt)("inlineCode",{parentName:"p"},"ExampleController")," in ",(0,a.kt)("a",{parentName:"p",href:"/docs/swagger-ui#setup-swagger-ui"},"Swagger UI")," section before."),(0,a.kt)("p",null,"To respond mock on ",(0,a.kt)("inlineCode",{parentName:"p"},"postSomething")," method, we need to attach ",(0,a.kt)("inlineCode",{parentName:"p"},"Emsifa\\Evo\\Http\\Response\\Mock")," like an example below:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php",metastring:"{8,16}","{8,16}":!0},"<?php\n\nnamespace App\\Http\\Controllers;\n\nuse Illuminate\\Http\\Request;\nuse Emsifa\\Evo\\Route\\Post;\nuse Emsifa\\Evo\\Route\\RoutePrefix;\nuse Emsifa\\Evo\\Http\\Response\\Mock;\nuse App\\Dtos\\PostSomethingDto;\nuse App\\Http\\Responses\\PostSomethingResponse;\n\n#[RoutePrefix('examples')]\nclass ExampleController extends Controller\n{\n    #[Post('post-something')]\n    #[Mock]\n    public function postSomething(\n        #[Body] PostSomethingDto $dto\n    ): PostSomethingResponse\n    {\n        return PostSomethingResponse::fromArray($dto);\n    }\n}\n")),(0,a.kt)("p",null,"That's it!"),(0,a.kt)("p",null,"To try this, open your Swagger UI page. Expand ",(0,a.kt)("inlineCode",{parentName:"p"},"POST /api/examples/post-something")," endpoint, click ",(0,a.kt)("inlineCode",{parentName:"p"},"Try it out"),", then click execute."),(0,a.kt)("p",null,"You should see it responded with random data."),(0,a.kt)("h2",{id:"using-specific-faker"},"Using Specific Faker"),(0,a.kt)("p",null,"Behind the scene Evo uses Faker to generate mock data. By default Evo choosing faker to be used is by looking the data type and the name of each property."),(0,a.kt)("p",null,"For example, if you have ",(0,a.kt)("inlineCode",{parentName:"p"},"$name")," property, Evo will use ",(0,a.kt)("inlineCode",{parentName:"p"},"$faker->name()"),". For ",(0,a.kt)("inlineCode",{parentName:"p"},"$title")," property, Evo will use ",(0,a.kt)("inlineCode",{parentName:"p"},"$faker->title()"),". For ",(0,a.kt)("inlineCode",{parentName:"p"},"float $latitude"),", Evo will use ",(0,a.kt)("inlineCode",{parentName:"p"},"$faker->latitude()"),". If the property name doesn't have related faker formatter available, Evo will choose faker formatter by it's data type."),(0,a.kt)("p",null,"If you want to use another faker instead of default choosed faker. You can use ",(0,a.kt)("inlineCode",{parentName:"p"},"Emsifa\\Evo\\Dtos\\UseFaker")," to define what formatter you want to use."),(0,a.kt)("p",null,"For example, we will use ",(0,a.kt)("inlineCode",{parentName:"p"},"paragraphs(5, true)")," formatter to ",(0,a.kt)("inlineCode",{parentName:"p"},"$message")," property."),(0,a.kt)("p",null,"Here is the code:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php",metastring:"{5,13}","{5,13}":!0},'<?php\n\nnamespace App\\Http\\Responses;\n\nuse Emsifa\\Evo\\Dtos\\UseFaker;\nuse Emsifa\\Evo\\Http\\Response\\JsonResponse;\n\n#[Description("Post something succeed")]\nclass PostSomethingResponse extends JsonResponse\n{\n    public int $number;\n\n    #[UseFaker("paragraph", 5, true)]\n    public string $message;\n}\n')),(0,a.kt)("p",null,"Now when you execute your endpoint again, it will respond ",(0,a.kt)("inlineCode",{parentName:"p"},"message")," with paragraph contains 5 sentences."),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"For complete formatter available, see ",(0,a.kt)("a",{parentName:"p",href:"https://fakerphp.github.io/"},"Faker Documentation"),".")),(0,a.kt)("h2",{id:"create-custom-faker"},"Create Custom Faker"),(0,a.kt)("p",null,"You can also create your own faker generator by creating a class that implement ",(0,a.kt)("inlineCode",{parentName:"p"},"Emsifa\\Evo\\Contracts\\ValueFaker")," interface. Then, write your generator logic in ",(0,a.kt)("inlineCode",{parentName:"p"},"generateFakeValue")," method. After that, you can just put its class name in ",(0,a.kt)("inlineCode",{parentName:"p"},"UseFaker")," attribute before."),(0,a.kt)("p",null,"For example, we will create ",(0,a.kt)("inlineCode",{parentName:"p"},"CategoryFaker")," that receive ",(0,a.kt)("inlineCode",{parentName:"p"},"string $type"),", if ",(0,a.kt)("inlineCode",{parentName:"p"},"$type"),' is framework, it will return value either "Laravel", "Express.js", or "Next.js". Else, it will return either "Dessert", "Appetizer", or "Cocktail".'),(0,a.kt)("p",null,"Create ",(0,a.kt)("inlineCode",{parentName:"p"},"app/Fakers/CategoryFaker.php")," file with following code below:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php"},'<?php\n\nnamespace App\\Fakers;\n\nuse Emsifa\\Evo\\Contracts\\ValueFaker;\nuse Faker\\Generator;\nuse ReflectionProperty;\n\nclass CategoryFaker implements ValueFaker\n{\n    public function __construct(protected string $type)\n    {\n    }\n\n    public function generateFakeValue(Generator $faker, ReflectionProperty $property): mixed\n    {\n        if ($this->type == "framework") {\n            return $faker->randomElement(["Laravel", "Express.js", "Nest.js"]);\n        } else {\n            return $faker->randomElement(["Dessert", "Appetizer", "Cocktail"]);\n        }\n    }\n}\n')),(0,a.kt)("p",null,"To use this, we can simply put ",(0,a.kt)("inlineCode",{parentName:"p"},'"App\\Fakers\\CategoryFaker"')," in ",(0,a.kt)("inlineCode",{parentName:"p"},"UseFaker")," attribute like following code below:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php",metastring:"{7,14,17}","{7,14,17}":!0},'<?php\n\nnamespace App\\Http\\Responses;\n\nuse Emsifa\\Evo\\Dtos\\UseFaker;\nuse Emsifa\\Evo\\Http\\Response\\JsonResponse;\nuse App\\Fakers\\CategoryFaker;\n\n#[Description("Post something succeed")]\nclass PostSomethingResponse extends JsonResponse\n{\n    public int $number;\n    \n    #[UseFaker(CategoryFaker::class)]\n    public string $meal;\n\n    #[UseFaker(CategoryFaker::class, "framework")]\n    public string $framework;\n}\n')))}m.isMDXComponent=!0}}]);